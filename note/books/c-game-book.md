# ゲーム開発で学ぶ C言語入門

## わからなかったこと
- [ ] `#include <stdio.h>`などのヘッダファイル
- [ ] `scanf()` の使い方
- [ ] `if(strcmp(a, b) == 0)` の使い方
- [ ] マクロ定義やマクロ関数とは


## 調べたこと
<details>
<summary>`if(strcmp(a, b) == 0)` の使い方</summary>

### `strcmp()` とは？
 - C言語で2つの文字列を比較する関数。
 - `strcmp(str1, str2)`
 - if文では `if(strcmp(a, b) == 0)` のように使う
 -ヘッダファイル `<string.h>` が必要。

### 戻り値（返り値）
 - 0　→　2つの文字列がまったく同じ
 - 0より小さい値　→　str1 が str2 より辞書順で前
 - 0より大きい値　→　str1 が str2 より辞書順で後

```c
char a[] = "apple";
char b[] = "apple";

if(strcmp(a, b) == 0) {
    printf("2つの文字列は同じです！\n");
} else {
    printf("違う文字列です！\n");
}
```

</details>

<details>
<summary>`scanf()` の使い方</summary>

### 基本の書式
```c
scanf("書式指定子", 変数のアドレス);
```
### 例
```c
(整数の入力)
int num;
scanf("%d", &num);  // 整数値をnumに入力

(文字列の入力)
char str[100];
scanf("%s", str);   // 文字列（空白まで）をstrに入力
```

### 変数のアドレスが必要

- &num のように「&（アンパサンド）」を付ける
→ これは「numという変数の場所」を表します
- 書式指定子はprintfと同じ
- %d: 整数
- %f: 小数（float型/double型）
- %c: 1文字
- %s: 文字列（空白まで）
</details>

<details>
<summary>ヘッダファイルの処理について</summary>

### ヘッダファイルが読み込まれたとき何が起こっているの？

1. ヘッダファイルとは？
   - 関数や型、定数などの「宣言」が書いてあるファイルです。
   - 例えば`#include <stdio.h>なら、printfやscanfなどの宣言がまとめてあります。

2. 処理の流れ
   1. プリプロセッサ（前処理）が #include を見つける
   2. #include <...>や#include "..."で指定したファイルの中身が、ソースコードにそのままコピーされる
      - #include <stdio.h> → stdio.hの内容が全部ここにコピペされるイメージ！
   3. その後でコンパイルされる「宣言があるから使えるよ！」とコンパイラが分かる

3. 何のためにあるの？
   - **関数や型の「使い方の説明書」**をまとめて管理するため
   - プログラムごとに毎回関数の説明を書くのは大変だから、みんなで共通の説明書（ヘッダファイル）を読むイメージ

4. 具体的にどんなものが入ってる？

```c
(関数のプロトタイプ宣言)
int printf(const char *format, ...);

(マクロや定数の定義)
#define NULL 0

(構造体や型定義)
typedef struct {...} FILE;
```
### 裏側で起きていること（イメージ）

#### 例

```c
#include <stdio.h>
```
↓
（プリプロセッサが読み込む…）

```c
// --- stdio.h の内容がここに貼り付けられる ---
// int printf(const char *format, ...);
// ...他にもたくさんの宣言やマクロ...
```
↓
コンパイルされる！

### まとめ
- ヘッダファイルは「標準のライブラリや関数をつかうために必要」！
- プリプロセッサが #include を見つけると、中身を自動でソースにコピペ
- `printf`などの関数を使おうとすると「どんな引数で呼ぶのかコンパイラが分からず」エラーや警告が出る

</details>

<details>
<summary>マクロ定義とマクロ関数</summary>

## マクロ定義とは
- ソースコードの中で「特定の文字列や値，式」を"置き換え"できる仕組み
- C言語の「プリプロセッサ命令」の1つです。

### 基本の書き方
```c
#define マクロ名　置き換えする文字列や数値

(例)
#define QUIZ_MAX 5
```
↑ c-test-section4/quiz_2 のヘッダに書かれている。

## マクロ関数とは
- #define で「引数つきの置き換えルール」を定義したもの
- 関数のように引数を指定して使えるが、実際にはコンパイル前に単なるテキスト置換が行われる

### 使い方

```c
#define SQUARE(x) ((x) * (x))
#define MAX(a,b) ((a) > (b) ? (a) : (b))
```

### 使い方の例

```c
#include <stdio.h>
#define PI 3.14159
#define SQUARE(x) ((x)*(x))

int main() {
    double r = 5.0;
    double area = PI * SQUARE(r); // = 3.14159 * (5.0*5.0)
    printf("円の面積は%fです\n", area);
    return 0;
}
```

```c
#include <stdio.h>
#define SQUARE(x) ((x) * (x))
#define MAX(a,b) ((a) > (b) ? (a) : (b))

int main()
{
   int a = 5;
   int b = 10;
   int s = SQUARE(a);      // ((a) * (a))  → 5*5 = 25
   int m = MAX(a, b);      // ((a) > (b) ? (a) : (b)) → bが大きいので10
}
```
### ポイント
- 関数のように使えるけど「本物の関数」ではない
→ プリプロセッサが文字列として機械的に置換する
- 関数と違って型が無いので、何にでも使える
- そのため計算途中の副作用や、カッコの付け忘れに注意！

### ⚠️注意
:::message alert
上記のコードを以下のように変更すると...
```c
#define SQUARE(x) ((x) * (x))
int i = 2;
int x = SQUARE(i++); // ((i++) * (i++)) → iが2回増える！
```
i++ の処理はiを使ったら、iを+1する」
つまり、
```
1回目の i++ → 2を使う（iは3になる）
2回目の i++ → 3を使う（iは4になる）
```
このように「テキストの書き換え」が2回起こることになります
そのため計算は以下のようになります
```
2 * 3 = 6 // 1回目のi++ = 2 , 2回目のi++ = 3
```
本来期待している「同じ値での計算」(2*2)ではなくなってしまう。

⚠️マクロ関数には（++や--）などを使わないのが安全です⚠️

:::

</details>